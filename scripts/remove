#!/bin/bash

# Exit on command errors and treat unset variables as an error
set -u

source .fonctions	# Loads the generic functions usually used in the script
source /usr/share/yunohost/helpers # Source app helpers

# Retrieves application info.
app=$YNH_APP_INSTANCE_NAME
domain=$(ynh_app_setting_get $app domain)

REMOVE_BDD $app	# Deleting the database and the associated user.

SECURE_REMOVE '/var/www/${app}'	# Removing the application folder

REMOVE_NGINX_CONF	# Deleting the nginx configuration

REMOVE_FPM_CONF	# Deleting the php-fpm pool configuration

# Reload SSOwat configuration
sudo yunohost app ssowatconf

echo -e "\e[0m"	# Restore normal color